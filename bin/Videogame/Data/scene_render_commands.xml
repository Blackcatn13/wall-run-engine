<?xml version="1.0" encoding="ISO-8859-1"?>
<scene_renderer_commands>
	 <!--pre_render-->
	<clear_scene color="true" depth="true" stencil="true"/>
	<begin_scene /> 
	<enable_z_write/>
	<enable_z_test/>
	<disable_alpha_blend /> 
	<!--
	<set_axis />
	-->
	<!--<set_pool_renderable_objects_technique pool="generate_shadow_map_renderable_obejcts_technique"/>-->
	<!-- <generate_shadow_maps /> -->
	<set_pool_renderable_objects_technique pool="generate_deferred_shading_pool_renderable_object_technique"/>
	<set_render_target name="deferred_multiple_render_target" >
		<dynamic_texture stage_id="0" name="DiffuseMapTexture" texture_width_as_frame_buffer="true" format_type="A8R8G8B8"/>
		<dynamic_texture stage_id="1" name="LightMapTexture" texture_width_as_frame_buffer="true" format_type="A8R8G8B8"/>
		<dynamic_texture stage_id="2" name="NormalMapTexture" texture_width_as_frame_buffer="true" format_type="A8R8G8B8"/>
		<dynamic_texture stage_id="3" name="DepthMapTexture" texture_width_as_frame_buffer="true" format_type="R32F"/>
	</set_render_target>
	<clear_scene color="true" depth="true" stencil="true"/> 
	<set_matrices/>
	<enable_z_write/>
	<enable_z_test/>
	<render_scene layer="solid" active="true"/>
	

	<unset_render_target render_target="deferred_multiple_render_target"/>
	<disable_z_write/>
	<disable_z_test />

	<set_pool_renderable_objects_technique pool="draw_textured_quad_pool"/>
	<render_draw_quad technique_name="DrawQuadSolidTechnique"> 
		<texture stage_id="0" file="LightMapTexture"/>
	</render_draw_quad>
	
	<!--<deferred_shading/>-->
	<enable_alpha_blend />

	<!-- Segunda pasada TODO-->
	<enable_z_write/>
	<enable_z_test/>
					
	<!--render_debug_lights/-->
	<!--render_gui/-->
	 <render_debug_scene layer="solid" active="true"/>
	
	<capture_frame_buffer> 
		<dynamic_texture stage_id="0" name="MyTexture" texture_width_as_frame_buffer="true" format_type="A8R8G8B8"/>
	</capture_frame_buffer>
	<end_scene/>
	<!--end pre_render-->
	<present/>
</scene_renderer_commands>
